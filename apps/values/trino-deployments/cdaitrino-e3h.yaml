# Trino instance configuration for cdaitrino-e3h
# This instance uses a feature branch for testing
trinoDeployment:
  name: cdaitrino-e3h
  description: Trino instance cdaitrino-e3h (TEST)

# Kubernetes cluster where this instance will be deployed
# Note: Can be deployed to same cluster as other instances
# Use the cluster name as registered in ArgoCD
cluster:
  name: ipc-cluster-1  # Same cluster as trino-ipc1

# Git repository configuration
# Using feature branch for testing new changes
git:
  repoURL: https://github.com/your-org/your-repo.git
  targetRevision: feature/cdaitrino-e3h-testing

# AppProject configuration
appProject:
  name: cdaitrino-e3h
  description: AppProject for Trino instance cdaitrino-e3h (TEST)
  sourceRepos:
    - '*'
  destinations:
    - namespace: cdaitrino-e3h
      name: ipc-cluster-1
    - namespace: vault
      name: ipc-cluster-1
  clusterResourceWhitelist:
    - group: '*'
      kind: '*'
  namespaceResourceWhitelist:
    - group: '*'
      kind: '*'
  orphanedResources:
    warn: true

# Application configurations
applications:
  trino:
    enabled: true
    namespace: cdaitrino-e3h
    chart:
      path: charts/trino/trino-1.41.0.tgz
    valuesFile: apps/values/trino/cdaitrino-e3h-values.yaml
    syncPolicy:
      automated:
        prune: true
        selfHeal: true
        allowEmpty: false
      syncOptions:
        - CreateNamespace=true
        - ServerSideApply=true
      retry:
        limit: 5
        backoff:
          duration: 5s
          factor: 2
          maxDuration: 3m

  vault:
    enabled: true
    namespace: vault
    chart:
      repoURL: https://helm.releases.hashicorp.com
      name: vault
      version: 0.28.0
    valuesFile: apps/values/vault/cdaitrino-e3h-values.yaml
    syncPolicy:
      automated:
        prune: true
        selfHeal: true
        allowEmpty: false
      syncOptions:
        - CreateNamespace=true
        - ServerSideApply=true
      retry:
        limit: 5
        backoff:
          duration: 5s
          factor: 2
          maxDuration: 3m
    ignoreDifferences:
      - group: admissionregistration.k8s.io
        kind: MutatingWebhookConfiguration
        jqPathExpressions:
          - '.webhooks[]?.clientConfig.caBundle'

  vaultSecrets:
    enabled: true
    valuesFile: apps/values/vault-secrets/cdaitrino-e3h-values.yaml
    syncPolicy:
      automated:
        prune: true
        selfHeal: true
        allowEmpty: false
      syncOptions:
        - CreateNamespace=true
        - ServerSideApply=true
      retry:
        limit: 5
        backoff:
          duration: 5s
          factor: 2
          maxDuration: 3m

# Made with Bob
