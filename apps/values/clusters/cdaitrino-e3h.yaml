# Cluster configuration for cdaitrino-e3h instance
# This cluster uses a feature branch for testing
cluster:
  name: cdaitrino-e3h
  server: https://kubernetes.default.svc

# Git repository configuration
# Using feature branch for testing new changes
git:
  repoURL: https://github.com/your-org/your-repo.git
  targetRevision: feature/cdaitrino-e3h-testing  # Test branch instead of HEAD/main

# AppProject configuration
appProject:
  name: cdaitrino-e3h
  description: AppProject for cdaitrino-e3h instance (TEST environment)
  sourceRepos:
    - '*'
  destinations:
    - namespace: cdaitrino-e3h
      server: https://kubernetes.default.svc
    - namespace: vault
      server: https://kubernetes.default.svc
  clusterResourceWhitelist:
    - group: '*'
      kind: '*'
  namespaceResourceWhitelist:
    - group: '*'
      kind: '*'
  orphanedResources:
    warn: true

# Application configurations
applications:
  trino:
    enabled: true
    namespace: cdaitrino-e3h
    chart:
      repoURL: https://trinodb.github.io/charts
      name: trino
      version: 0.19.0
    valuesFile: apps/values/trino/cdaitrino-e3h-values.yaml
    syncPolicy:
      automated:
        prune: true
        selfHeal: true
        allowEmpty: false
      syncOptions:
        - CreateNamespace=true
        - ServerSideApply=true
      retry:
        limit: 5
        backoff:
          duration: 5s
          factor: 2
          maxDuration: 3m

  vault:
    enabled: true
    namespace: vault
    chart:
      repoURL: https://helm.releases.hashicorp.com
      name: vault
      version: 0.28.0
    valuesFile: apps/values/vault/cdaitrino-e3h-values.yaml
    syncPolicy:
      automated:
        prune: true
        selfHeal: true
        allowEmpty: false
      syncOptions:
        - CreateNamespace=true
        - ServerSideApply=true
      retry:
        limit: 5
        backoff:
          duration: 5s
          factor: 2
          maxDuration: 3m
    ignoreDifferences:
      - group: admissionregistration.k8s.io
        kind: MutatingWebhookConfiguration
        jqPathExpressions:
          - '.webhooks[]?.clientConfig.caBundle'

# Git repository for values files
valuesRepo:
  url: https://github.com/your-org/your-repo.git
  targetRevision: HEAD

# Made with Bob